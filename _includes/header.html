<header>
<div class="logo">
  <a href="{{ site.baseurl }}/">
    <img src="{{ site.baseurl }}/assets/images/logo.svg" alt="{{ site.title }} Logo">
  </a>
</div>

  <nav>
  <!-- MAIN MENU -->
<div id="mainMenu" class="main-menu">
  <ul id="autoNav" class="main-nav">
    <li>
      <a href="{{ site.baseurl }}/about/">About</a>
    </li>
    <li>
      <a href="{{ site.baseurl }}/contact/">Contact</a>
    </li>
    <li>
      <a href="{{ site.baseurl }}/shop/">Shop</a>
    </li>
    <li>
      <a href="{{ site.baseurl }}/arcade/">Arcade</a>
    </li>
    <li>
      <a href="{{ site.baseurl }}/hub/">Hub</a>
    </li>
    <li id="autoNavMore" class="auto-nav-more">
      <a href="#" class="more-btn">More</a>
      <ul id="autoNavMoreList" class="auto-nav-more-list">
        <li>
          <a href="{{ site.baseurl }}/donate/">Donate</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </ul>
  </nav>


</header>

      <div class="background-container" id="backgroundContainer">
        <div class="shape-overlay" id="shapeOverlay"></div>
    </div>
<div id="monthOverlay" class="month-overlay"></div>






<script>
  const clientId = "725662594004-dn93rj2929o73vf21cq95srvvuvap5t2.apps.googleusercontent.com"; // Replace with your actual Google Client ID

  // Check if user is logged in (from localStorage)
  const userLoggedIn = localStorage.getItem('userLoggedIn') === 'true';

  // Function to initialize Google API
  function initializeGoogle() {
    if (!window.google || !google.accounts) {
      console.warn("Google API not available yet. Retrying initialization...");
      setTimeout(initializeGoogle, 1000); // Retry after 1 second
      return;
    }

    // Initialize Google API
    google.accounts.id.initialize({
      client_id: clientId,
      callback: handleGoogleResponse,
      error_callback: (error) => {
        console.error("Google Sign-In Error: ", error);
        alert("Google Sign-In failed. Please try again later.");
      },
    });

    // Render buttons only if not logged in
    if (!userLoggedIn) {
      const googleEnrollButton = document.getElementById("googleEnroll");
      const googleAccessButton = document.getElementById("googleAccess");

      if (googleEnrollButton) {
        google.accounts.id.renderButton(googleEnrollButton, {
          theme: "outline",
          size: "large",
          text: "signup_with",
        });
      }

      if (googleAccessButton) {
        google.accounts.id.renderButton(googleAccessButton, {
          theme: "outline",
          size: "large",
          text: "signin_with",
        });
      }
    } else {
      // Update UI for logged-in state
      updateUIAfterLogin();
    }
  }

  // Google response handler after login
  function handleGoogleResponse(response) {
    console.log("Google Response: ", response);
    alert("Logged in successfully!");

    // Store login state in localStorage
    localStorage.setItem('userLoggedIn', 'true');

    // Update UI after login
    updateUIAfterLogin();
  }

  // Update UI after successful login
  function updateUIAfterLogin() {
    // Hide Enroll and Access buttons and show Profile button
    const enrollBtn = document.getElementById('enrollBtn');
    const accessBtn = document.getElementById('accessBtn');

    if (enrollBtn) enrollBtn.style.display = 'none';
    if (accessBtn) accessBtn.style.display = 'none';

    const profileBtn = document.createElement('button');
    profileBtn.textContent = 'Profile';
    profileBtn.addEventListener('click', showProfile);
    document.querySelector('.access-bar').appendChild(profileBtn);
  }

  // Show Profile
  function showProfile() {
    window.location.href = "https://m-cochran.github.io/Randomerr/profile/";
  }

  // Logout function
  function logout() {
    alert("You have been logged out.");
    localStorage.setItem('userLoggedIn', 'false');
    window.location.reload();
  }

  // Load Google API dynamically and initialize when ready
  if (!userLoggedIn) {
    const googleScript = document.createElement('script');
    googleScript.src = "https://accounts.google.com/gsi/client";
    googleScript.async = true;
    googleScript.defer = true;

    googleScript.onload = initializeGoogle;
    document.body.appendChild(googleScript);
  } else {
    initializeGoogle();
  }

  // Attach event listeners after DOM is fully loaded
  document.addEventListener("DOMContentLoaded", () => {
    const enrollBtn = document.getElementById("enrollBtn");
    const accessBtn = document.getElementById("accessBtn");

    if (enrollBtn) {
      enrollBtn.addEventListener("click", () => openModal("enrollModal"));
    }

    if (accessBtn) {
      accessBtn.addEventListener("click", () => openModal("accessModal"));
    }
  });

  // Modal controls
  function openModal(modalId) {
    closeAllModals();
    const modal = document.getElementById(modalId);
    if (modal) modal.classList.add("active");
  }

  function closeModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) modal.classList.remove("active");
  }

  function closeAllModals() {
    document.querySelectorAll(".modal").forEach((modal) => modal.classList.remove("active"));
  }
</script>




