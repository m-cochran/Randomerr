<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Invaders Game</title>
    <style>
        body { 
            margin: 0; 
            background: #000; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
        }
        canvas { 
            background: #000; 
            border: 1px solid #fff; 
        }
    </style>
</head>
<body>
    <canvas id="spaceInvadersCanvas" width="800" height="600"></canvas>
    <script>
        const canvas = document.getElementById('spaceInvadersCanvas');
        const ctx = canvas.getContext('2d');

        // Player properties
        const player = {
            x: canvas.width / 2 - 25,
            y: canvas.height - 50,
            width: 50,
            height: 10,
            dx: 4
        };

        // Bullet properties
        const bullets = [];
        const bulletWidth = 5;
        const bulletHeight = 20;
        const bulletSpeed = 6;

        // Enemy properties
        const enemies = [];
        const enemyWidth = 40;
        const enemyHeight = 30;
        const enemyRows = 3;
        const enemyCols = 5;
        const enemySpeed = 2;
        let enemyDirection = 1; // 1 for right, -1 for left

        // Game variables
        let rightPressed = false;
        let leftPressed = false;
        let spacePressed = false;
        let score = 0;
        let gameOver = false;

        // Initialize enemies
        function createEnemies() {
            for (let row = 0; row < enemyRows; row++) {
                enemies[row] = [];
                for (let col = 0; col < enemyCols; col++) {
                    enemies[row][col] = {
                        x: col * (enemyWidth + 10) + 30,
                        y: row * (enemyHeight + 10) + 30,
                        width: enemyWidth,
                        height: enemyHeight,
                        alive: true
                    };
                }
            }
        }
        createEnemies();

        function drawPlayer() {
            ctx.fillStyle = "#fff";
            ctx.fillRect(player.x, player.y, player.width, player.height);
        }

        function drawBullets() {
            ctx.fillStyle = "#f00";
            for (const bullet of bullets) {
                ctx.fillRect(bullet.x, bullet.y, bulletWidth, bulletHeight);
            }
        }

        function drawEnemies() {
            ctx.fillStyle = "#0f0";
            for (const row of enemies) {
                for (const enemy of row) {
                    if (enemy.alive) {
                        ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
                    }
                }
            }
        }

        function movePlayer() {
            if (rightPressed && player.x < canvas.width - player.width) {
                player.x += player.dx;
            } else if (leftPressed && player.x > 0) {
                player.x -= player.dx;
            }
        }

        function shootBullet() {
            if (spacePressed) {
                bullets.push({
                    x: player.x + player.width / 2 - bulletWidth / 2,
                    y: player.y,
                    width: bulletWidth,
                    height: bulletHeight
                });
                spacePressed = false; // Reset space pressed
            }
        }

        function moveBullets() {
            for (let i = bullets.length - 1; i >= 0; i--) {
                const bullet = bullets[i];
                bullet.y -= bulletSpeed;
                if (bullet.y < 0) {
                    bullets.splice(i, 1); // Remove bullet if off screen
                }
            }
        }

        function moveEnemies() {
            let changeDirection = false;
            for (const row of enemies) {
                for (const enemy of row) {
                    if (enemy.alive) {
                        enemy.x += enemySpeed * enemyDirection;
                        if (enemy.x < 0 || enemy.x > canvas.width - enemy.width) {
                            changeDirection = true;
                        }
                    }
                }
            }
            if (changeDirection) {
                enemyDirection *= -1;
                for (const row of enemies) {
                    for (const enemy of row) {
                        enemy.y += 20; // Move down when changing direction
                    }
                }
            }
        }

        function detectCollisions() {
            // Bullet and enemy collisions
            for (let i = bullets.length - 1; i >= 0; i--) {
                const bullet = bullets[i];
                for (const row of enemies) {
                    for (const enemy of row) {
                        if (enemy.alive && bullet.x < enemy.x + enemy.width &&
                            bullet.x + bulletWidth > enemy.x &&
                            bullet.y < enemy.y + enemy.height &&
                            bullet.y + bulletHeight > enemy.y) {
                            enemy.alive = false;
                            bullets.splice(i, 1);
                            score += 10;
                            break;
                        }
                    }
                }
            }

            // Enemy and player collisions
            for (const row of enemies) {
                for (const enemy of row) {
                    if (enemy.alive && enemy.y + enemy.height > player.y) {
                        gameOver = true;
                    }
                }
            }
        }

        function drawScore() {
            ctx.fillStyle = "#fff";
            ctx.font = "20px Arial";
            ctx.fillText("Score: " + score, 10, 20);
        }

        function drawGameOver() {
            ctx.fillStyle = "#f00";
            ctx.font = "50px Arial";
            ctx.fillText("Game Over", canvas.width / 2 - 150, canvas.height / 2);
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            if (!gameOver) {
                drawPlayer();
                drawBullets();
                drawEnemies();
                drawScore();
                movePlayer();
                shootBullet();
                moveBullets();
                moveEnemies();
                detectCollisions();
            } else {
                drawGameOver();
            }
        }

        document.addEventListener("keydown", function (e) {
            if (e.key === "ArrowRight") {
                rightPressed = true;
            } else if (e.key === "ArrowLeft") {
                leftPressed = true;
            } else if (e.key === " ") {
                spacePressed = true;
            }
        });

        document.addEventListener("keyup", function (e) {
            if (e.key === "ArrowRight") {
                rightPressed = false;
            } else if (e.key === "ArrowLeft") {
                leftPressed = false;
            } else if (e.key === " ") {
                spacePressed = false;
            }
        });

        setInterval(draw, 20);
    </script>
</body>
</html>
